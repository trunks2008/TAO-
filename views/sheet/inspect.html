<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>inspect</title>

		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">

		<link rel="stylesheet" href="../../css/mui.min.css">
		<link rel="stylesheet" href="../../css/mui.picker.min.css" />
		<link rel="stylesheet" href="../../css/mui.poppicker.css" />

		<script src="../../js/mui.min.js"></script>
		<script src="../../js/hour.data.js"></script>
		<script src="../../js/mui.picker.js"></script>
		<script src="../../js/mui.poppicker.js"></script>
		<script src="../../js/mui.picker.min.js"></script>
		<script src="../../js/timeutils.js"></script>
		<script src="../../js/constants.js"></script>
		<script src="../../js/ajaxutils.js"></script>
		<script src="../../js/serverutils.js"></script>

		<style>
			.subtitle {
				color: #1699C5;
			}
			
			.formgroup {
				padding-top: 5px;
				padding-bottom: 5px;
				vertical-align: middle;
			}
			
			.formgroupspan {
				padding-top: 11px;
				padding-left: 15px;
				font-size: 17px;
				vertical-align: middle;
			}
			
			.rowarea {
				padding-left: 2px;
				padding-right: 2px;
				font-size: 14px;
				font-weight: 400;
				line-height: 1.42;
				position: relative;
				display: inline-block;
				margin-bottom: 0;
				padding: 6px 12px;
				cursor: pointer;
				transition: all;
				transition-timing-function: linear;
				transition-duration: .2s;
				vertical-align: top;
				white-space: nowrap;
				color: #333;
				border: 1px solid #1699C5 !important;
				border-radius: 3px !important;
				border-top-left-radius: 3px;
				border-top-right-radius: 3px;
				border-bottom-right-radius: 3px;
				border-bottom-left-radius: 3px;
				background-color: #fff;
				background-clip: padding-box;
				background: #1699C5;
			}
			
			.mybtn {
				border: 1.5px solid #1699C5;
			}
			
			.mui-badge1 {
				padding: 0px;
				width: 65%;
				float: right;
				line-height: 42px;
				font-size: 14px;
			}
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 class="mui-title">值班巡视</h1>
		</header>

		<div class="mui-content">
			<div class="mui-card">
				<form class="mui-input-group" style="margin: 5px;">

					<div class="mui-input-group formgroup">
						<div class="mui-row">
							<div class="mui-col-sm-4 mui-col-xs-4">
								<div class="formgroupspan subtitle">巡视日期:</div>
							</div>
							<div class="mui-col-sm-8 mui-col-xs-8">
								<button type="button" class="mui-btn mybtn subtitle" id="start">请点击选择日期 </button>
							</div>
						</div>
					</div>

					<div class="mui-input-group formgroup">
						<div class="mui-row">
							<div class="mui-col-sm-4 mui-col-xs-4">
								<div class="formgroupspan subtitle">巡视时间:</div>
							</div>
							<div class="mui-col-sm-8 mui-col-xs-8">
								<button type="button" class="mui-btn mybtn subtitle" id="timePicker">请点击选择时间</button>
							</div>
						</div>
					</div>

					<div class="mui-input-group formgroup">
						<div class="mui-row">
							<div class="mui-col-sm-4 mui-col-xs-4">
								<div class="formgroupspan subtitle">机房温度:</div>
							</div>
							<div class="mui-col-sm-8 mui-col-xs-8">
								<input id="temperature" type="text" class="mui-input-clear" placeholder="请输入机房温度">
							</div>
						</div>
					</div>

					<div class="mui-input-group formgroup">
						<div class="mui-row">
							<div class="mui-col-sm-4 mui-col-xs-4">
								<div class="formgroupspan subtitle">机房湿度:</div>
							</div>
							<div class="mui-col-sm-8 mui-col-xs-8">
								<input id="humidity" type="text" class="mui-input-clear" placeholder="请输入机房湿度">
							</div>
						</div>
					</div>

					<div class="mui-input-group formgroup">
						<div class="mui-row">
							<div class="mui-col-sm-4 mui-col-xs-4">
								<div class="formgroupspan subtitle">UPS电压:</div>
							</div>
							<div class="mui-col-sm-8 mui-col-xs-8">
								<input id="ups" type="text" class="mui-input-clear" placeholder="请输入ups电压">
							</div>
						</div>
					</div>

					<div class="mui-input-group formgroup">
						<div class="mui-row">
							<div class="mui-col-sm-5 mui-col-xs-5">
								<div class="formgroupspan subtitle">6号门取号机:</div>
							</div>
							<div class="mui-col-sm-7 mui-col-xs-7">
								<a class="mui-navigate-right">
									<span class="mui-badge1">
								<select id="6hao" class="mui-h5" style="margin:auto; color:#000;">
									<option value="0">正常</option>
									<option value="1">故障</option>								
								</select>
								</span>
								</a>
							</div>
						</div>
					</div>

					<div class="mui-input-group formgroup">
						<div class="mui-row">
							<div class="mui-col-sm-5 mui-col-xs-5">
								<div class="formgroupspan subtitle">7号口取号机:</div>
							</div>
							<div class="mui-col-sm-7 mui-col-xs-7">
								<a class="mui-navigate-right">
									<span class="mui-badge1">
								<select id="7hao" class="mui-h5" style="margin:auto; color:#000;">
									<option value="0">正常</option>
									<option value="1">故障</option>								
								</select>
								</span>
								</a>
							</div>
						</div>
					</div>

					<div class="mui-input-group formgroup">
						<div class="mui-row">
							<div class="mui-col-sm-5 mui-col-xs-5">
								<div class="formgroupspan subtitle">自助行李托运:</div>
							</div>
							<div class="mui-col-sm-7 mui-col-xs-7">
								<a class="mui-navigate-right">
									<span class="mui-badge1">
								<select id="self" class="mui-h5" style="margin:auto; color:#000;">
									<option value="0">正常</option>
									<option value="1">故障</option>								
								</select>
								</span>
								</a>
							</div>
						</div>
					</div>

					<div class="mui-input-group formgroup">
						<div class="mui-row">
							<div class="mui-col-sm-4 mui-col-xs-4">
								<div class="formgroupspan subtitle">巡视人员:</div>
							</div>
							<div class="mui-col-sm-8 mui-col-xs-8">
								<input id="people" type="text" class="mui-input-clear" placeholder="请输入巡视人员姓名">
							</div>
						</div>
					</div>

					<div class="mui-input-group formgroup" style="height: 150px;">
						<span class="formgroupspan subtitle">巡视内容:</span>
						<div style="padding-left: 11px;padding-right: 11px;padding-top: 5px;padding-bottom: 10px;">
							<textarea id="content" class="rowarea" name="textarea" placeholder="请输入巡视内容" rows="5"></textarea>
						</div>
					</div>

				</form>

				<div class="mui-content-padded">
					<div class="mui-button-row">
						<button type="button" class="mui-btn mui-btn-primary " id="submit">提交</button>
						<button type="button" class="mui-btn mui-btn-danger" id="clear">查看历史</button>
					</div>
				</div>
			</div>
		</div>

		<script>
			(function($, doc) {
				$.init();

				$.ready(function() {

					var nowdate = new Date().Format("yyyy-MM-dd");
					document.getElementById('start').innerHTML = nowdate;
					document.getElementById('start').addEventListener('tap', function() {
						var dtPicker = new mui.DtPicker({　　　　
							"type": "date"
						});
						dtPicker.show(function(rs) {
							document.getElementById('start').innerHTML = rs.text;
						});　
					})

					//time btn
					var timePicker = new $.PopPicker({
						layer: 2
					});
					timePicker.setData(hourData);
					var showTimePickerButton = doc.getElementById('timePicker');

					var sttime = 'null';
					var edtime = 'null';
					showTimePickerButton.addEventListener('tap', function(event) {
						timePicker.show(function(items) {
							sttime = items[0].text;
							edtime = items[1].text;
							showTimePickerButton.innerHTML = items[0].text + " - " + items[1].text;
						});
					}, false);

					//submit
					doc.getElementById('submit').addEventListener('tap', function() {
						var sdate = doc.getElementById('start').innerHTML;
						var content = doc.getElementById('content').value;

						var temvalue = doc.getElementById('temperature').value;
						var humvalue = doc.getElementById('humidity').value;
						var upsvalue = doc.getElementById('ups').value;
						var peovalue = doc.getElementById('people').value;

						var sixvalue = doc.getElementById('6hao').value;
						var sevenvalue = doc.getElementById('7hao').value;
						var selfvalue = doc.getElementById('self').value;

						//						console.log(sixvalue+sevenvalue+selfvalue)

						var data = {
							'sdate': sdate,
							'sttime': sttime,
							'edtime': edtime,
							'temvalue': temvalue,
							'humvalue': humvalue,
							'upsvalue': upsvalue,
							'peovalue': peovalue,
							'content': content,
							'sixvalue': sixvalue,
							'sevenvalue': sevenvalue,
							'selfvalue': selfvalue
						};

						postData(SERVER_HOST_FORMAL + MODULE_INSPECT, data,
							function(ret) {
								//								console.log(ret);
								if(ret == '1') {
									plus.nativeUI.toast('提交成功');

									doc.getElementById('timePicker').innerHTML = '请点击选择时间';
									doc.getElementById('content').value = '';

									doc.getElementById('temperature').value = '';
									doc.getElementById('humidity').value = '';
									doc.getElementById('ups').value = '';
									doc.getElementById('people').value = '';

								} else {
									plus.nativeUI.toast('提交失败');
								}
							},
							null
						);
					});

					doc.getElementById('clear').addEventListener('tap', function() {
						//history
						mui.openWindow({
							url: '../subviews/inspecthistory.html',
							id: 'inspecthistory.html',
							show: {
								autoShow: true,
								aniShow: "slide-in-right",
								duration: '150'
							},
							extras: {
								isout: true
							},
							waiting: {
								autoShow: false,
								title: '正在加载...'
							}
						});
					});
				});
			})(mui, document);
		</script>
	</body>

</html>